[
["fixed-effects-modelle.html", "Abschnitt 3 Fixed effects Modelle 3.1 Konzeptionelle Einführung 3.2 Fixed effects Modelle in der praktischen Anwendung", " Abschnitt 3 Fixed effects Modelle 3.1 Konzeptionelle Einführung Im ersten Teil des Abschnitts zu fixed effects Modellen beschäftigen wir uns mit den Grundlagen der Modellierung. Dazu nutzen wir stats::lm() (übliche OLS-Schätzung linearer Modelle in R). Wie können wir den kauselen (within-person) Effekt mit Paneldaten schätzen? Separate OLS Modelle für jede Person schätzen und Koeffizeinten mitteln (no pooling). Alle \\(X\\) und \\(Y\\) Variablen um die Mittelwerte der Person zentrieren (within transformation). Dummy-Variablen für jede Person in das Regressionsmodell aufnehmen (least squares dummy variables [LSDV] estimation). Alle drei Varianten entfernen die (beobachteten und nicht beobachten,) über die Zeit konstanten Unterschiede zwischen den Personen. Varianten 2 und 3 entsprechen dem klassischen fixed effects Modell. Die Unterschiede zwischen den Personen werden kontrolliert, indem die personenspezifischen Mittelwerte vor der Schätzung entfernt werden (2) oder für jede Person im Modell geschätzt werden (3). \\(y_{it}-\\bar{y_{i}} = (x_{it} - \\bar{x_{i}})&#39;\\beta + (u_{it} - \\bar{u_{i}})\\) oder \\(y_{it} = \\beta&#39; x_{it}&#39; + \\alpha_i + u_{it}\\) In Variante 1 dürfen die kausalen within-person Effekte zwischen den Personen variieren. Unter der Annahme homogener Treatment-Effekte (entspricht der typischen Annahme im randomisierten Between-Subject-Experiment) entspricht das Ergebnis asymptotisch den Varianten 2 und 3. Der Schätzer ist aber weniger effizient, da zufällige Unterschiede in den Effekten zwischen den Personen aufgegriffen werden. Im letzten Teil des Abschnitts zum within-between-Modell kommen wir auf diesen Punkt zurück, wenn wir die Annahme homogener Treatment-Effekte lockern. No pooling d %&gt;% group_by(IDsosci) %&gt;% # mutate(chk = sd(verh1) != 0 &amp; sd(verhint1) != 0) %&gt;% filter(chk) %&gt;% nest() %&gt;% mutate(mdls = map(data, ~tidy(lm(verh1 ~ verhint1, data = .x)))) %&gt;% unnest(mdls) %&gt;% ungroup() %&gt;% select(-data) %&gt;% na.omit() %&gt;% filter(statistic != Inf) %&gt;% filter(term == &quot;verhint1&quot;) %&gt;% mutate_if(is.numeric, round, 2) %&gt;% print %&gt;% summarise(estimate = mean(estimate), std.error = sqrt(mean(std.error^2))) # simple approximation ## # A tibble: 236 x 6 ## IDsosci term estimate std.error statistic p.value ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 050IPY verhint1 1.25 0.56 2.24e+ 0 0.15 ## 2 05J4R8 verhint1 0.45 0.18 2.50e+ 0 0.13 ## 3 08BDZJ verhint1 0.33 0.53 6.30e- 1 0.59 ## 4 0EO9L2 verhint1 1.67 0.67 2.50e+ 0 0.13 ## 5 0F5L9Z verhint1 0 0.71 0. 1 ## 6 0KYYAJ verhint1 0.45 0.18 2.50e+ 0 0.13 ## 7 0ONV4O verhint1 1 0 9.01e+15 0 ## 8 0Q5XIM verhint1 -0.27 0.31 -8.70e- 1 0.48 ## 9 0ZCKB5 verhint1 -0.35 0.5 -6.90e- 1 0.56 ## 10 114OWA verhint1 0.33 0.33 1.00e+ 0 0.42 ## # … with 226 more rows ## # A tibble: 1 x 2 ## estimate std.error ## &lt;dbl&gt; &lt;dbl&gt; ## 1 0.493 0.520 Wir erhalten für jede Person einen Schätzer mit Standardfehler. Wir können diese mitteln, um einen Schätzer des durchschnittlichen kausalen Effekts zu erhalten. Wir müssen die Schätzer entfernen, bei denen es wegen eines perfekten Zusammenhangs oder wegen fehlender intraindividueller Varianz keine OLS Lösung gibt. Within Transformation d_wi = d %&gt;% select(IDsosci, verh1, verhint1) %&gt;% group_by(IDsosci) %&gt;% mutate(verh1_wi = verh1 - mean(verh1), verhint1_wi = verhint1 - mean(verhint1)) %&gt;% ungroup() d_wi %&gt;% select(-IDsosci) %&gt;% summary ## verh1 verhint1 verh1_wi verhint1_wi ## Min. :1.000 Min. :1.0 Min. :-3.00 Min. :-3.00 ## 1st Qu.:1.000 1st Qu.:1.0 1st Qu.:-0.25 1st Qu.:-0.25 ## Median :1.000 Median :1.0 Median : 0.00 Median : 0.00 ## Mean :1.526 Mean :1.8 Mean : 0.00 Mean : 0.00 ## 3rd Qu.:2.000 3rd Qu.:2.0 3rd Qu.: 0.00 3rd Qu.: 0.00 ## Max. :5.000 Max. :5.0 Max. : 3.00 Max. : 3.00 d_wi %&gt;% lm(verh1_wi ~ verhint1_wi, data = .) %&gt;% tidy() %&gt;% mutate_if(is.numeric, round, 2) ## # A tibble: 2 x 5 ## term estimate std.error statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 (Intercept) 0 0.01 0 1 ## 2 verhint1_wi 0.34 0.01 24.7 0 Intuitive Interpretation: Eine Abweichung vom Personen-Durchschnitt in \\(X\\) um einen Punkt führt zu einer Abweichung vom Personen-Durchschnitt in \\(Y\\) um \\(b_{X}\\) Punkte. Hier: Wenn eine Person um einen Punkt wahrscheinlicher rausgehen möchte als üblich, dann wird sie 0.34 Punkte häufiger rausgehen (beides auf 5er Skalen). Das ist durchaus ein bedeutsamer Effekt. Aber zur Erinnerung: Der naiven pooled OLS Schätzung zufolge war der Effekt fast doppelt so groß. Least Squares mit Dummy Variablen (LSDV) d %&gt;% lm(verh1 ~ verhint1 + factor(IDsosci), data = .) %&gt;% tidy() %&gt;% mutate_if(is.numeric, round, 2) %&gt;% print(n = 17) ## # A tibble: 586 x 5 ## term estimate std.error statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 (Intercept) 0.66 0.28 2.32 0.02 ## 2 verhint1 0.34 0.02 21.4 0 ## 3 factor(IDsosci)02E6C8 -0.34 0.4 -0.85 0.39 ## 4 factor(IDsosci)050IPY 1.23 0.4 3.04 0 ## 5 factor(IDsosci)05J4R8 0.32 0.4 0.81 0.42 ## 6 factor(IDsosci)08BDZJ 0.98 0.4 2.42 0.02 ## 7 factor(IDsosci)0BHGLF 0.570 0.4 1.43 0.15 ## 8 factor(IDsosci)0EB6C1 0 0.4 0 1 ## 9 factor(IDsosci)0EO9L2 1.97 0.4 4.87 0 ## 10 factor(IDsosci)0F5L9Z 1.65 0.4 4.09 0 ## 11 factor(IDsosci)0KAKHF 2.22 0.4 5.49 0 ## 12 factor(IDsosci)0KYYAJ -0.01 0.4 -0.01 0.99 ## 13 factor(IDsosci)0ONV4O 0.33 0.4 0.82 0.41 ## 14 factor(IDsosci)0PKFWT -0.09 0.4 -0.21 0.83 ## 15 factor(IDsosci)0Q5XIM 0.32 0.4 0.81 0.42 ## 16 factor(IDsosci)0ZCKB5 0.32 0.4 0.81 0.42 ## 17 factor(IDsosci)114OWA 0.33 0.4 0.82 0.41 ## # … with 569 more rows Der Punktschätzer \\(b_{X}\\) entspricht genau dem Punktschätzer nach der within-person Transformation. Zusätzlich gibt die Regressionskonstante den Mittelwert für Person 1 an und die \\(n - 1\\) Koeffizienten der Dummy-Variablen die Abweichung der übrigen Personen von diesem Mittelwert. Es gelten die üblichen Regeln für die Interpretation solcher Koeffizienten. Welche Modellspezifikation soll ich nutzen? Der Schätzer des durchschnittlichen kausalen Effekts in der no pooling Spezifikation ist im Vergleich zu den beiden anderen Varianten weniger effizient. Außerdem ist er praktisch schwieriger zu ermitteln, da er erst aus den Schätzern der Einzel-Modelle berechnet werden muss. Wenn wir die Annahme eines homogenen kausalen Effekts treffen (und das tun wir üblicherweise), dann gibt es keinen Grund, das no pooling Modell in der Praxis zu verwenden. Die Spezifikationen mit within-person Transformation und LSDV ergeben dieselben Punktschätzer für den kausalen Effekt und sind insofern austauschbar. Die Standardfehler des Modells mit einer naiven within-person Transformation (wie oben dargestellt) sind zu klein, da wir die Stichprobenmittelwerte und nicht die (mit Unsicherheit behafteten) Schätzer der Populationsmittelwerte zur Zentrierung verwenden. Die Standardfehler müssen daher angepasst werden (passiert in spezialisierten Software-Paketen automatisch). Die LSDV Spezifikation ist in fast jedem Softwarepaket einfach umzusetzen. Mit großen Datensätzen wird aber die Schätzung langsam und der Output unübersichtlich. Unabhängig von der Spezifikation gelten weiterhin alle Annahmen der (OLS) Regression. Besonders gern vergessen wird der omitted variable bias durch nicht gemessene, über die Zeit variierdene \\(Z\\). Fixed effects Modelle kontrollieren nur die \\(Z\\), die auf konstante Merkmale der als fixed effects spezifizierten Einheiten zurückgehen. Insgesamt sind viele quantitative Sozialforscher (v.a. die mit einer Ökonometrie-Ausbildung) der Ansicht, dass fixed effects Modelle die beste Methode sind, um kausale Effekte aus nicht-experimentellen Daten zu schätzen. 3.1.1 Mehre fixed effects in einem Modell – Perioden-Effekte Grundsätzlich können in einem Modell beliebig viele fixed effects spezifiziert werden. In Paneldaten ist der Erhebungszeitpunkt bzw. die Ergebungsperiode (Panelwelle) eine typische Variable, über die verschiedene, für alle Personen konstante Effekte kontrolliert werden können. Einige Lehrbücher empfehlen, dies immer zu tun, da kausale Effekte von Ereignissen, die für alle Einheiten konstant sind, statistisch nicht identifiziert sind. Eine typische Spezifikation ist die Aufnahme eines fixed effects für den Indikator der Panelwelle. In der LSDV-Spezifikation kann einfach ein weiterer Dummy-Faktor hinzugefügt werden. Die within-person Transformation ist mathematisch komplizierter, wird aber in spezialisierten Software-Pakten im Hintergrund erledigt. Es können auch beide Spezifikationen kombiniert werden, wenn z.B. die Periodeneffekte von inhaltlichem Interesse sind und im Output angezeigt werden sollen (siehe nächsten Teilabschnitt). Ein Beispiel mit fixed effects für Personen und Perioden d %&gt;% lm(verh1 ~ verhint1 + factor(wave) + factor(IDsosci), data = .) %&gt;% tidy() %&gt;% mutate_if(is.numeric, round, 2) %&gt;% print(n = 17) ## # A tibble: 589 x 5 ## term estimate std.error statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 (Intercept) 0.61 0.28 2.15 0.03 ## 2 verhint1 0.32 0.02 19.6 0 ## 3 factor(wave)2 0.02 0.03 0.66 0.51 ## 4 factor(wave)3 0.14 0.03 4.25 0 ## 5 factor(wave)4 0.12 0.03 3.53 0 ## 6 factor(IDsosci)02E6C8 -0.32 0.4 -0.81 0.42 ## 7 factor(IDsosci)050IPY 1.28 0.4 3.19 0 ## 8 factor(IDsosci)05J4R8 0.35 0.4 0.87 0.39 ## 9 factor(IDsosci)08BDZJ 1.03 0.4 2.57 0.01 ## 10 factor(IDsosci)0BHGLF 0.6 0.4 1.5 0.13 ## 11 factor(IDsosci)0EB6C1 0 0.4 0 1 ## 12 factor(IDsosci)0EO9L2 2.04 0.4 5.06 0 ## 13 factor(IDsosci)0F5L9Z 1.69 0.4 4.23 0 ## 14 factor(IDsosci)0KAKHF 2.29 0.4 5.68 0 ## 15 factor(IDsosci)0KYYAJ 0.01 0.4 0.02 0.99 ## 16 factor(IDsosci)0ONV4O 0.34 0.4 0.85 0.4 ## 17 factor(IDsosci)0PKFWT -0.08 0.4 -0.2 0.84 ## # … with 572 more rows \\(b_{verhint1}\\) quantifiziert weiterhin den kausalen Effekt von Interesse. Er ist robust gegen die Kontrolle des Periodeneffekts. Die \\(b_{wave_t}\\) zeigen den Kontrast zur ersten Welle. In diesem Fall sind liegen in der dritten und vierten Welle die Häufigkeiten des Rausgehens höher als noch in den ersten beiden Wellen. Die \\(b_{id_i}\\) zeigen weiterhin den Kontrast zu Person 1 (substantiell nicht sonderlich interessant). Übungsaufgaben zur grundsätzlichen Spezifikation von fixed effects Modellen Schätze den kausalen Effekt der Informationshäufigkeit aus öffentlich-rechtlichen TV-Programmen (med2) auf die Intention, weniger als 1.5m Abstand zu einer Person zu halten, die nicht im eigenen Haushalt lebt (verhint3). Schätze zuerst das falsche pooled OLS Modell. Schätze dann das einfache fixed effects Modell mit einer Spezifikation freier Wahl. Vergleiche schließlich die Modelle mit und ohne Periodeneffekt. Spezifiziere, schätze und interpretiere ein eigenes bivariates fixed effects Modell mit Daten aus dem Beipsieldatensatz. 3.2 Fixed effects Modelle in der praktischen Anwendung Auch wenn wir das fixed effects Modell nur mit stats::lm() und der LSDV-Spezifikation schätzen können, ist die weitere Arbeit mit diesen Modellen nicht ideal - besonders, wenn wir tiefer in Detail-Anpassungen einsteigen. Zudem wird das Schätzen bei großen Datensätzen mit vielen fixed effects langsam. plm (Croissant, Millo, and Tappe 2020) ist das etablierte Paket für das Schätzen von ökonometrischen Panel-Modellen in R. Es bietet ein einfaches Interface zu allen Standardmodellen. Das Schätzen der Modelle basiert auf OLS mit Datentransformationen im Hintergrund. Dadurch ist das Schätzen wesentlich schneller als mit einer LSDV-Spezifikation. Die notwendigen Anpassungen der Standardfehler werden ebenfalls vorgenommen. Spezifikation eines einfachen fixed effects Modells mit plm d %&gt;% plm(verh1 ~ verhint1, data = ., index = &quot;IDsosci&quot;, model = &quot;within&quot;) %&gt;% summary() ## Oneway (individual) effect Within Model ## ## Call: ## plm(formula = verh1 ~ verhint1, data = ., model = &quot;within&quot;, index = &quot;IDsosci&quot;) ## ## Balanced Panel: n = 585, T = 4, N = 2340 ## ## Residuals: ## Min. 1st Qu. Median 3rd Qu. Max. ## -3.000000 -0.164731 0.000000 0.091076 3.000000 ## ## Coefficients: ## Estimate Std. Error t-value Pr(&gt;|t|) ## verhint1 0.341076 0.015955 21.377 &lt; 2.2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Total Sum of Squares: 708.75 ## Residual Sum of Squares: 562.26 ## R-Squared: 0.20669 ## Adj. R-Squared: -0.057896 ## F-statistic: 456.992 on 1 and 1754 DF, p-value: &lt; 2.22e-16 Das fixed effects Modell wird über model = &quot;within&quot; angefordert. Mit index = &quot;IDsosci&quot; wird der Indikator für die Einheiten angegeben. Der Output von summary() liefert eine korrekte Beschreibung der Fallzahlen im Datensatz. Beachte: Das angepasste \\(R^2\\) ist hier (wie in vielen fixed effects Modellen) negativ. Das ist kein Grund zur Beunruhigung. Die Logik dahinter kann gut nachvollzogen werden, wenn wir uns die LSDV-Spezifikation in Erinnerung rufen. Zusätzlich zu den inhaltlich relevanten Prädiktoren enthält das Modell \\(n - 1\\) Prädiktoren für die Einheiten. 3.2.1 Mehre fixed effects in einem Modell – Perioden-Effekte mit plm plm bietet zwei Möglichkeiten, die Perioden-Effekte zu spezifizieren (identische Ergebnisse, anderer Output): Zwei Indices index=c(&quot;IDsosci&quot;, &quot;wave&quot;) und effect = &quot;twoways&quot; für die within-Transformation. Es wird “still” für Personen und Perioden kontrolliert, beide werden nicht im Output angezeigt. Das \\(R^2\\) bezieht sich nur auf die Varianzaufklärung durch die Prädiktoren. Perioden-Effekt als Dummies hinzufügen. Praktisch, wenn es nur wenige Perioden gibt und wir die Ergebnisse dazu direkt im Output sehen wollen. Das \\(R^2\\) bezieht sich auf die Varianzaufklärung durch die Prädiktoren und den Perioden-Effekt. d %&gt;% plm(verh1 ~ verhint1, data = ., effect = &quot;twoways&quot;, model = &quot;within&quot;, index = c(&quot;IDsosci&quot;, &quot;wave&quot;)) %&gt;% summary() ## Twoways effects Within Model ## ## Call: ## plm(formula = verh1 ~ verhint1, data = ., effect = &quot;twoways&quot;, ## model = &quot;within&quot;, index = c(&quot;IDsosci&quot;, &quot;wave&quot;)) ## ## Balanced Panel: n = 585, T = 4, N = 2340 ## ## Residuals: ## Min. 1st Qu. Median 3rd Qu. Max. ## -3.070876 -0.178852 0.010011 0.130070 3.049183 ## ## Coefficients: ## Estimate Std. Error t-value Pr(&gt;|t|) ## verhint1 0.323548 0.016485 19.626 &lt; 2.2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Total Sum of Squares: 675.75 ## Residual Sum of Squares: 553.9 ## R-Squared: 0.18032 ## Adj. R-Squared: -0.09494 ## F-statistic: 385.19 on 1 and 1751 DF, p-value: &lt; 2.22e-16 d %&gt;% plm(verh1 ~ verhint1 + factor(wave), data = ., index = &quot;IDsosci&quot;, model = &quot;within&quot;) %&gt;% summary() ## Oneway (individual) effect Within Model ## ## Call: ## plm(formula = verh1 ~ verhint1 + factor(wave), data = ., model = &quot;within&quot;, ## index = &quot;IDsosci&quot;) ## ## Balanced Panel: n = 585, T = 4, N = 2340 ## ## Residuals: ## Min. 1st Qu. Median 3rd Qu. Max. ## -3.070876 -0.178852 0.010011 0.130070 3.049183 ## ## Coefficients: ## Estimate Std. Error t-value Pr(&gt;|t|) ## verhint1 0.323548 0.016485 19.6263 &lt; 2.2e-16 *** ## factor(wave)2 0.021965 0.033314 0.6593 0.5097795 ## factor(wave)3 0.142024 0.033429 4.2485 2.265e-05 *** ## factor(wave)4 0.120603 0.034168 3.5297 0.0004268 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Total Sum of Squares: 708.75 ## Residual Sum of Squares: 553.9 ## R-Squared: 0.21848 ## Adj. R-Squared: -0.043954 ## F-statistic: 122.38 on 4 and 1751 DF, p-value: &lt; 2.22e-16 Literatur "]
]
