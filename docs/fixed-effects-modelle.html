<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Abschnitt 3 Fixed effects Modelle | Mini-Workshop Panel Data Analysis</title>
  <meta name="description" content="Material für den Mini-Workshop Panel Data Analysis" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Abschnitt 3 Fixed effects Modelle | Mini-Workshop Panel Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Material für den Mini-Workshop Panel Data Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Abschnitt 3 Fixed effects Modelle | Mini-Workshop Panel Data Analysis" />
  
  <meta name="twitter:description" content="Material für den Mini-Workshop Panel Data Analysis" />
  

<meta name="author" content="Marko Bachl (mit Material von Michael Scharkow)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="einführung.html"/>
<link rel="next" href="random-effects-modelle.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Panel Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Überblick</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#inhalt-des-virtuellen-mini-workshops"><i class="fa fa-check"></i><b>1.1</b> Inhalt des virtuellen Mini-Workshops</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#welche-inhalte-wir-nicht-behandeln"><i class="fa fa-check"></i><b>1.2</b> Welche Inhalte wir nicht behandeln</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#aufbau-des-workshops"><i class="fa fa-check"></i><b>1.3</b> Aufbau des Workshops</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="einführung.html"><a href="einführung.html"><i class="fa fa-check"></i><b>2</b> Einführung</a><ul>
<li class="chapter" data-level="2.1" data-path="einführung.html"><a href="einführung.html#längsschnittdaten"><i class="fa fa-check"></i><b>2.1</b> Längsschnittdaten</a></li>
<li class="chapter" data-level="2.2" data-path="einführung.html"><a href="einführung.html#beispiel-daten"><i class="fa fa-check"></i><b>2.2</b> Beispiel-Daten</a></li>
<li class="chapter" data-level="2.3" data-path="einführung.html"><a href="einführung.html#pooled-ols-wrong"><i class="fa fa-check"></i><b>2.3</b> Pooled OLS (WRONG!)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fixed-effects-modelle.html"><a href="fixed-effects-modelle.html"><i class="fa fa-check"></i><b>3</b> Fixed effects Modelle</a><ul>
<li class="chapter" data-level="3.1" data-path="fixed-effects-modelle.html"><a href="fixed-effects-modelle.html#konzeptionelle-einführung"><i class="fa fa-check"></i><b>3.1</b> Konzeptionelle Einführung</a></li>
<li class="chapter" data-level="3.2" data-path="fixed-effects-modelle.html"><a href="fixed-effects-modelle.html#übungsaufgaben-1"><i class="fa fa-check"></i><b>3.2</b> Übungsaufgaben 1</a></li>
<li class="chapter" data-level="3.3" data-path="fixed-effects-modelle.html"><a href="fixed-effects-modelle.html#fixed-effects-modelle-in-der-praktischen-anwendung"><i class="fa fa-check"></i><b>3.3</b> <em>Fixed effects</em> Modelle in der praktischen Anwendung</a></li>
<li class="chapter" data-level="3.4" data-path="fixed-effects-modelle.html"><a href="fixed-effects-modelle.html#zusammenfassung-vor--und-nachteile-des-fixed-effects-modells"><i class="fa fa-check"></i><b>3.4</b> Zusammenfassung: Vor- und Nachteile des <em>fixed effects</em> Modells</a></li>
<li class="chapter" data-level="3.5" data-path="fixed-effects-modelle.html"><a href="fixed-effects-modelle.html#übungsaufgaben-2"><i class="fa fa-check"></i><b>3.5</b> Übungsaufgaben 2</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="random-effects-modelle.html"><a href="random-effects-modelle.html"><i class="fa fa-check"></i><b>4</b> <em>Random effects</em> Modelle</a><ul>
<li class="chapter" data-level="4.1" data-path="random-effects-modelle.html"><a href="random-effects-modelle.html#einführung-random-effects-modelle-für-paneldaten"><i class="fa fa-check"></i><b>4.1</b> Einführung: Random effects Modelle für Paneldaten</a></li>
<li class="chapter" data-level="4.2" data-path="random-effects-modelle.html"><a href="random-effects-modelle.html#random-effects-modelle-mit-plm"><i class="fa fa-check"></i><b>4.2</b> Random effects Modelle mit <code>plm</code></a></li>
<li class="chapter" data-level="4.3" data-path="random-effects-modelle.html"><a href="random-effects-modelle.html#kurze-einführung-zu-mixed-effects-modellen"><i class="fa fa-check"></i><b>4.3</b> Kurze Einführung zu mixed effects Modellen</a></li>
<li class="chapter" data-level="4.4" data-path="random-effects-modelle.html"><a href="random-effects-modelle.html#übungsaufgaben-3"><i class="fa fa-check"></i><b>4.4</b> Übungsaufgaben 3</a></li>
<li class="chapter" data-level="4.5" data-path="random-effects-modelle.html"><a href="random-effects-modelle.html#random-effects-panel-modelle-mit-lme4"><i class="fa fa-check"></i><b>4.5</b> Random effects panel Modelle mit <code>lme4</code></a></li>
<li class="chapter" data-level="4.6" data-path="random-effects-modelle.html"><a href="random-effects-modelle.html#übungsaufgaben-4"><i class="fa fa-check"></i><b>4.6</b> Übungsaufgaben 4</a></li>
<li class="chapter" data-level="4.7" data-path="random-effects-modelle.html"><a href="random-effects-modelle.html#variierende-koeffizienten-random-slopes-und-ebenen-überschreitende-interaktionen-cross-level-interactions"><i class="fa fa-check"></i><b>4.7</b> Variierende Koeffizienten (random slopes) und Ebenen-überschreitende Interaktionen (cross-level interactions)</a></li>
<li class="chapter" data-level="4.8" data-path="random-effects-modelle.html"><a href="random-effects-modelle.html#übungsaufgaben-5"><i class="fa fa-check"></i><b>4.8</b> Übungsaufgaben 5</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hybride-within-between-modelle.html"><a href="hybride-within-between-modelle.html"><i class="fa fa-check"></i><b>5</b> Hybride <em>within-between</em> Modelle</a><ul>
<li class="chapter" data-level="5.1" data-path="hybride-within-between-modelle.html"><a href="hybride-within-between-modelle.html#das-beste-aus-beiden-welten"><i class="fa fa-check"></i><b>5.1</b> Das Beste aus beiden Welten?</a></li>
<li class="chapter" data-level="5.2" data-path="hybride-within-between-modelle.html"><a href="hybride-within-between-modelle.html#spezifikation-des-within-between-modells"><i class="fa fa-check"></i><b>5.2</b> Spezifikation des <em>within-between</em> Modells</a></li>
<li class="chapter" data-level="5.3" data-path="hybride-within-between-modelle.html"><a href="hybride-within-between-modelle.html#übungsaufgaben-6"><i class="fa fa-check"></i><b>5.3</b> Übungsaufgaben 6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="literatur.html"><a href="literatur.html"><i class="fa fa-check"></i>Literatur</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mini-Workshop Panel Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fixed-effects-modelle" class="section level1">
<h1><span class="header-section-number">Abschnitt 3</span> Fixed effects Modelle</h1>
<div id="konzeptionelle-einführung" class="section level2">
<h2><span class="header-section-number">3.1</span> Konzeptionelle Einführung</h2>
<ul>
<li>Im ersten Teil des Abschnitts zu <em>fixed effects</em> Modellen beschäftigen wir uns mit den Grundlagen der Modellierung. Dazu nutzen wir <code>stats::lm()</code> (übliche OLS-Schätzung linearer Modelle in <code>R</code>).</li>
</ul>
<div id="wie-können-wir-den-kausalen-within-person-effekt-mit-paneldaten-schätzen" class="section level3 unnumbered">
<h3>Wie können wir den kausalen (within-person) Effekt mit Paneldaten schätzen?</h3>
<ol style="list-style-type: decimal">
<li>Separate OLS Modelle für jede Person schätzen und Koeffizienten mitteln (no pooling).</li>
<li>Alle <span class="math inline">\(X\)</span> und <span class="math inline">\(Y\)</span> Variablen um die Mittelwerte der Person zentrieren (within transformation).</li>
<li>Dummy-Variablen für jede Person in das Regressionsmodell aufnehmen (least squares dummy variables [LSDV] estimation).</li>
</ol>
<ul>
<li>Alle drei Varianten entfernen die (beobachteten und nicht beobachten,) über die Zeit konstanten Unterschiede zwischen den Personen.</li>
<li>Varianten 2 und 3 entsprechen dem klassischen <em>fixed effects</em> Modell. Die Unterschiede zwischen den Personen werden kontrolliert, indem die personenspezifischen Mittelwerte vor der Schätzung entfernt werden (2) oder für jede Person im Modell geschätzt werden (3).
<ul>
<li><span class="math inline">\(y_{it}-\bar{y_{i}} = (x_{it} - \bar{x_{i}})&#39;\beta + (u_{it} - \bar{u_{i}})\)</span> oder <span class="math inline">\(y_{it} = \beta&#39; x_{it}&#39; + \alpha_i + u_{it}\)</span></li>
</ul></li>
<li>In Variante 1 dürfen die kausalen within-person Effekte zwischen den Personen variieren. Unter der Annahme homogener Treatment-Effekte (entspricht der typischen Annahme im randomisierten Between-Subject-Experiment) entspricht das Ergebnis asymptotisch den Varianten 2 und 3.
<ul>
<li>Der Schätzer ist aber weniger effizient, da zufällige Unterschiede in den Effekten zwischen den Personen aufgegriffen werden.</li>
<li>Im letzten Teil des Abschnitts zum within-between-Modell kommen wir auf diesen Punkt zurück, wenn wir die Annahme homogener Treatment-Effekte lockern.</li>
</ul></li>
</ul>
</div>
<div id="no-pooling" class="section level3 unnumbered">
<h3>No pooling</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="fixed-effects-modelle.html#cb8-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(IDsosci) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">mdls =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="kw">tidy</span>(<span class="kw">lm</span>(verh1 <span class="op">~</span><span class="st"> </span>verhint1, </span>
<span id="cb8-2"><a href="fixed-effects-modelle.html#cb8-2"></a>    <span class="dt">data =</span> .x)))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(mdls) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>data) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-3"><a href="fixed-effects-modelle.html#cb8-3"></a><span class="st">    </span><span class="kw">filter</span>(statistic <span class="op">!=</span><span class="st"> </span><span class="ot">Inf</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(term <span class="op">==</span><span class="st"> &quot;verhint1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_if</span>(is.numeric, </span>
<span id="cb8-4"><a href="fixed-effects-modelle.html#cb8-4"></a>    round, <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span>print <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">estimate =</span> <span class="kw">mean</span>(estimate), <span class="dt">std.error =</span> <span class="kw">sqrt</span>(<span class="kw">mean</span>(std.error<span class="op">^</span><span class="dv">2</span>)))  <span class="co"># simple approximation</span></span></code></pre></div>
<pre><code>## # A tibble: 232 x 6
##    IDsosci term     estimate std.error statistic p.value
##    &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
##  1 050IPY  verhint1     1.25      0.56  2.24e+ 0    0.15
##  2 05J4R8  verhint1     0.45      0.18  2.50e+ 0    0.13
##  3 08BDZJ  verhint1     0.33      0.53  6.30e- 1    0.59
##  4 0EO9L2  verhint1     1.67      0.67  2.50e+ 0    0.13
##  5 0F5L9Z  verhint1     0         0.71  0.          1   
##  6 0KYYAJ  verhint1     0.45      0.18  2.50e+ 0    0.13
##  7 0ONV4O  verhint1     1         0     9.01e+15    0   
##  8 0ZCKB5  verhint1    -0.35      0.5  -6.90e- 1    0.56
##  9 114OWA  verhint1     0.33      0.33  1.00e+ 0    0.42
## 10 16YGN0  verhint1     0.5       0.25  2.00e+ 0    0.18
## # … with 222 more rows</code></pre>
<pre><code>## # A tibble: 1 x 2
##   estimate std.error
##      &lt;dbl&gt;     &lt;dbl&gt;
## 1    0.502     0.521</code></pre>
<ul>
<li>Wir erhalten für jede Person einen Schätzer mit Standardfehler. Wir können diese mitteln, um einen Schätzer des durchschnittlichen kausalen Effekts zu erhalten.</li>
<li>Wir müssen die Schätzer entfernen, bei denen es wegen eines perfekten Zusammenhangs oder wegen fehlender intraindividueller Varianz keine OLS Lösung gibt.</li>
</ul>
</div>
<div id="within-transformation" class="section level3 unnumbered">
<h3>Within Transformation</h3>
<ul>
<li>Wir ziehen von jedem Messwert den Personenmittelwert ab. In das Modell gehen dann die um den Personenmittelwert bereinigten Variablen ein.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="fixed-effects-modelle.html#cb11-1"></a>d_wi =<span class="st"> </span>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(IDsosci, verh1, verhint1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(IDsosci) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">verh1_wi =</span> verh1 <span class="op">-</span><span class="st"> </span></span>
<span id="cb11-2"><a href="fixed-effects-modelle.html#cb11-2"></a><span class="st">    </span><span class="kw">mean</span>(verh1), <span class="dt">verhint1_wi =</span> verhint1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(verhint1)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>()</span>
<span id="cb11-3"><a href="fixed-effects-modelle.html#cb11-3"></a></span>
<span id="cb11-4"><a href="fixed-effects-modelle.html#cb11-4"></a>d_wi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>IDsosci) <span class="op">%&gt;%</span><span class="st"> </span>summary</span></code></pre></div>
<pre><code>##      verh1        verhint1      verh1_wi      verhint1_wi   
##  Min.   :1.0   Min.   :1.0   Min.   :-3.00   Min.   :-3.00  
##  1st Qu.:1.0   1st Qu.:1.0   1st Qu.:-0.25   1st Qu.:-0.25  
##  Median :1.0   Median :1.0   Median : 0.00   Median : 0.00  
##  Mean   :1.5   Mean   :1.8   Mean   : 0.00   Mean   : 0.00  
##  3rd Qu.:2.0   3rd Qu.:2.0   3rd Qu.: 0.00   3rd Qu.: 0.00  
##  Max.   :5.0   Max.   :5.0   Max.   : 3.00   Max.   : 3.00</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="fixed-effects-modelle.html#cb13-1"></a>d_wi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lm</span>(verh1_wi <span class="op">~</span><span class="st"> </span>verhint1_wi, <span class="dt">data =</span> .) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_if</span>(is.numeric, </span>
<span id="cb13-2"><a href="fixed-effects-modelle.html#cb13-2"></a>    round, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   term        estimate std.error statistic p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)     0         0.01       0         1
## 2 verhint1_wi     0.35      0.01      24.9       0</code></pre>
<ul>
<li>Intuitive Interpretation: Eine Abweichung vom Personen-Durchschnitt in <span class="math inline">\(X\)</span> um einen Punkt führt zu einer Abweichung vom Personen-Durchschnitt in <span class="math inline">\(Y\)</span> um <span class="math inline">\(b_{X}\)</span> Punkte.</li>
<li>Hier: Wenn eine Person um einen Punkt wahrscheinlicher raus gehen möchte als üblich, dann wird sie 0.34 Punkte häufiger raus gehen (beides auf 5er Skalen).</li>
<li>Das ist durchaus ein bedeutsamer Effekt. Aber zur Erinnerung: Der naiven pooled OLS Schätzung zufolge war der Effekt fast doppelt so groß. Es scheint also auch einen Unterschied zwischen Personen zugeben. Personen, die im Durchschnitt wahrscheinlicher raus gehen wollen, gehen im Durchschnitt auf häufiger raus.</li>
</ul>
</div>
<div id="least-squares-mit-dummy-variablen-lsdv" class="section level3 unnumbered">
<h3>Least Squares mit Dummy Variablen (LSDV)</h3>
<ul>
<li>Es wird ein Dummy-Indikator für jede <span class="math inline">\(n-1\)</span>te Person in das Modell aufgenommen.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="fixed-effects-modelle.html#cb15-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lm</span>(verh1 <span class="op">~</span><span class="st"> </span>verhint1 <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(IDsosci), <span class="dt">data =</span> .) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_if</span>(is.numeric, </span>
<span id="cb15-2"><a href="fixed-effects-modelle.html#cb15-2"></a>    round, <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>(<span class="dt">n =</span> <span class="dv">17</span>)</span></code></pre></div>
<pre><code>## # A tibble: 577 x 5
##    term                  estimate std.error statistic p.value
##    &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
##  1 (Intercept)              0.65       0.28      2.31    0.02
##  2 verhint1                 0.35       0.02     21.5     0   
##  3 factor(IDsosci)02E6C8   -0.35       0.4      -0.86    0.39
##  4 factor(IDsosci)050IPY    1.21       0.4       3.01    0   
##  5 factor(IDsosci)05J4R8    0.32       0.4       0.79    0.43
##  6 factor(IDsosci)08BDZJ    0.96       0.4       2.39    0.02
##  7 factor(IDsosci)0BHGLF    0.570      0.4       1.42    0.16
##  8 factor(IDsosci)0EB6C1    0          0.4       0       1   
##  9 factor(IDsosci)0EO9L2    1.95       0.4       4.82    0   
## 10 factor(IDsosci)0F5L9Z    1.64       0.4       4.06    0   
## 11 factor(IDsosci)0KAKHF    2.2        0.4       5.44    0   
## 12 factor(IDsosci)0KYYAJ   -0.01       0.4      -0.02    0.98
## 13 factor(IDsosci)0ONV4O    0.33       0.4       0.82    0.41
## 14 factor(IDsosci)0PKFWT   -0.09       0.4      -0.22    0.83
## 15 factor(IDsosci)0ZCKB5    0.32       0.4       0.79    0.43
## 16 factor(IDsosci)114OWA    0.33       0.4       0.82    0.41
## 17 factor(IDsosci)11KVRK   -0.17       0.4      -0.43    0.67
## # … with 560 more rows</code></pre>
<ul>
<li>Der Punktschätzer <span class="math inline">\(b_{X}\)</span> entspricht genau dem Punktschätzer nach der within-person Transformation.</li>
<li>Zusätzlich gibt die Regressionskonstante den Mittelwert für Person 1 an und die <span class="math inline">\(n - 1\)</span> Koeffizienten der Dummy-Variablen die Abweichung der übrigen Personen von diesem Mittelwert. Es gelten die üblichen Regeln für die Interpretation solcher Koeffizienten.</li>
</ul>
</div>
<div id="welche-modellspezifikation-soll-ich-nutzen" class="section level3 unnumbered">
<h3>Welche Modellspezifikation soll ich nutzen?</h3>
<ol style="list-style-type: decimal">
<li><p>Der Schätzer des durchschnittlichen kausalen Effekts in der no pooling Spezifikation ist im Vergleich zu den beiden anderen Varianten weniger effizient. Außerdem ist er praktisch schwieriger zu ermitteln, da er erst aus den Schätzern der Einzel-Modelle berechnet werden muss. Wenn wir die Annahme eines homogenen kausalen Effekts treffen (und das tun wir üblicherweise), dann gibt es keinen Grund, das no pooling Modell in der Praxis zu verwenden.</p></li>
<li><p>Die Spezifikationen mit within-person Transformation und LSDV ergeben dieselben Punktschätzer für den kausalen Effekt und sind insofern austauschbar.</p></li>
<li><p>Die Standardfehler des Modells mit einer naiven within-person Transformation (wie oben dargestellt) sind zu klein, da wir die Stichprobenmittelwerte und nicht die (mit Unsicherheit behafteten) Schätzer der Populationsmittelwerte zur Zentrierung verwenden. Die Standardfehler müssen daher angepasst werden (passiert in spezialisierten Software-Paketen automatisch).</p></li>
<li><p>Die LSDV Spezifikation ist in fast jedem Softwarepaket einfach umzusetzen. Mit großen Datensätzen wird aber die Schätzung langsam und der Output unübersichtlich.</p></li>
</ol>
<ul>
<li><p>Unabhängig von der Spezifikation gelten weiterhin alle Annahmen der (OLS) Regression. Besonders gern vergessen wird der <em>omitted variable bias</em> durch nicht gemessene, über die Zeit variierende <span class="math inline">\(Z\)</span>. <em>Fixed effects</em> Modelle kontrollieren nur die <span class="math inline">\(Z\)</span>, die auf konstante Merkmale der als <em>fixed effects</em> spezifizierten Einheiten zurückgehen.</p></li>
<li><p>Insgesamt sind viele quantitative Sozialforscher*innen (v.a. die mit einer Ökonometrie-Ausbildung) der Ansicht, dass <em>fixed effects</em> Modelle die beste Methode sind, um kausale Effekte aus nicht-experimentellen Daten zu schätzen.</p></li>
</ul>
</div>
<div id="mehre-fixed-effects-in-einem-modell-perioden-effekte" class="section level3 unnumbered">
<h3>Mehre fixed effects in einem Modell – Perioden-Effekte</h3>
<ul>
<li>Grundsätzlich können in einem Modell beliebig viele <em>fixed effects</em> spezifiziert werden.</li>
<li>In Paneldaten ist der Erhebungszeitpunkt bzw. die Erhebungsperiode (Panelwelle) eine typische Variable, über die verschiedene, für alle Personen konstante Effekte kontrolliert werden können.</li>
<li>Einige Lehrbücher empfehlen, dies <em>immer</em> zu tun, da kausale Effekte von Ereignissen, die für alle Einheiten konstant sind, statistisch nicht identifiziert sind.</li>
<li>Eine typische Spezifikation ist die Aufnahme eines <em>fixed effects</em> für den Indikator der Panelwelle.</li>
<li>In der LSDV-Spezifikation kann einfach ein weiterer Dummy-Faktor hinzugefügt werden. Die within-person Transformation ist mathematisch komplizierter, wird aber in spezialisierten Software-Pakten im Hintergrund erledigt. Es können auch beide Spezifikationen kombiniert werden, wenn z.B. die Periodeneffekte von inhaltlichem Interesse sind und im Output angezeigt werden sollen (siehe nächsten Teilabschnitt).</li>
</ul>
</div>
<div id="ein-beispiel-mit-fixed-effects-für-personen-und-perioden" class="section level3 unnumbered">
<h3>Ein Beispiel mit <em>fixed effects</em> für Personen und Perioden</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="fixed-effects-modelle.html#cb17-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lm</span>(verh1 <span class="op">~</span><span class="st"> </span>verhint1 <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(wave) <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(IDsosci), <span class="dt">data =</span> .) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-2"><a href="fixed-effects-modelle.html#cb17-2"></a><span class="st">    </span><span class="kw">mutate_if</span>(is.numeric, round, <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>(<span class="dt">n =</span> <span class="dv">17</span>)</span></code></pre></div>
<pre><code>## # A tibble: 580 x 5
##    term                  estimate std.error statistic p.value
##    &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
##  1 (Intercept)               0.6       0.28      2.13    0.03
##  2 verhint1                  0.33      0.02     19.8     0   
##  3 factor(wave)2             0.02      0.03      0.6     0.55
##  4 factor(wave)3             0.14      0.03      4.15    0   
##  5 factor(wave)4             0.12      0.03      3.41    0   
##  6 factor(IDsosci)02E6C8    -0.33      0.4      -0.83    0.41
##  7 factor(IDsosci)050IPY     1.26      0.4       3.15    0   
##  8 factor(IDsosci)05J4R8     0.34      0.4       0.85    0.39
##  9 factor(IDsosci)08BDZJ     1.01      0.4       2.53    0.01
## 10 factor(IDsosci)0BHGLF     0.59      0.4       1.48    0.14
## 11 factor(IDsosci)0EB6C1     0         0.4       0       1   
## 12 factor(IDsosci)0EO9L2     2.02      0.4       5.01    0   
## 13 factor(IDsosci)0F5L9Z     1.68      0.4       4.2     0   
## 14 factor(IDsosci)0KAKHF     2.27      0.4       5.63    0   
## 15 factor(IDsosci)0KYYAJ     0         0.4       0.01    0.99
## 16 factor(IDsosci)0ONV4O     0.34      0.4       0.84    0.4 
## 17 factor(IDsosci)0PKFWT    -0.08      0.4      -0.21    0.84
## # … with 563 more rows</code></pre>
<ul>
<li><span class="math inline">\(b_{verhint1}\)</span> quantifiziert weiterhin den kausalen Effekt von Interesse. Er ist robust gegen die Kontrolle des Periodeneffekts.</li>
<li>Die <span class="math inline">\(b_{wave_t}\)</span> zeigen den Kontrast zur ersten Welle. In diesem Fall sind liegen in der dritten und vierten Welle die Häufigkeiten des Rausgehens höher als noch in den ersten beiden Wellen.</li>
<li>Die <span class="math inline">\(b_{id_i}\)</span> zeigen weiterhin den Kontrast zu Person 1 (substantiell nicht sonderlich interessant).</li>
</ul>
</div>
</div>
<div id="übungsaufgaben-1" class="section level2">
<h2><span class="header-section-number">3.2</span> Übungsaufgaben 1</h2>
<ol style="list-style-type: decimal">
<li>Schätze den kausalen Effekt der Einstellung zum Verhalten, weniger als 1.5m Abstand zu Personen zu halten, die nicht im gleichen Haushalt leben <code>ein3</code>, auf die diesbezügliche Verhaltensintention (<code>verhint3</code>).
<ul>
<li>Schätze zuerst das <em>falsche</em> pooled OLS Modell.</li>
<li>Schätze dann das einfache <em>fixed effects</em> Modell mit einer Spezifikation deiner Wahl.</li>
<li>Vergleiche schließlich die Modelle mit und ohne Periodeneffekt.</li>
</ul></li>
<li>Spezifiziere, schätze und interpretiere ein eigenes bivariates <em>fixed effects</em> Modell mit Daten aus dem Beispieldatensatz.</li>
</ol>
</div>
<div id="fixed-effects-modelle-in-der-praktischen-anwendung" class="section level2">
<h2><span class="header-section-number">3.3</span> <em>Fixed effects</em> Modelle in der praktischen Anwendung</h2>
<ul>
<li>Auch wenn wir das <em>fixed effects</em> Modell nur mit <code>stats::lm()</code> und der LSDV-Spezifikation schätzen können, ist die weitere Arbeit mit diesen Modellen nicht ideal - besonders, wenn wir tiefer in Detail-Anpassungen einsteigen.</li>
<li>Zudem wird das Schätzen mit <code>stats::lm()</code> und LSDV bei großen Datensätzen und mit vielen <em>fixed effects</em> langsam.</li>
<li><code>plm</code> <span class="citation">(Croissant, Millo, and Tappe <a href="#ref-R-plm" role="doc-biblioref">2020</a>)</span> ist das etablierte Paket für das Schätzen von ökonometrischen Panel-Modellen in <code>R</code>. Es bietet ein einfaches Interface zu allen Standardmodellen (und zu den übrigen Klassikern der Ökonometrie, instrumental variables, differences in differences).</li>
<li>Das Schätzen der Modelle basiert auf OLS mit Datentransformationen im Hintergrund. Dadurch ist das Schätzen wesentlich schneller als mit einer LSDV-Spezifikation. Die notwendigen Anpassungen der Standardfehler werden ebenfalls vorgenommen.</li>
</ul>
<div id="spezifikation-eines-einfachen-fixed-effects-modells-mit-plm" class="section level3 unnumbered">
<h3>Spezifikation eines einfachen <em>fixed effects</em> Modells mit <code>plm</code></h3>
<ul>
<li>Das <em>fixed effects</em> Modell wird über <code>model = "within"</code> angefordert. Mit <code>index = "IDsosci"</code> wird der Indikator für die Einheiten angegeben.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="fixed-effects-modelle.html#cb19-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">plm</span>(verh1 <span class="op">~</span><span class="st"> </span>verhint1, <span class="dt">data =</span> ., <span class="dt">index =</span> <span class="st">&quot;IDsosci&quot;</span>, <span class="dt">model =</span> <span class="st">&quot;within&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>## Oneway (individual) effect Within Model
## 
## Call:
## plm(formula = verh1 ~ verhint1, data = ., model = &quot;within&quot;, index = &quot;IDsosci&quot;)
## 
## Balanced Panel: n = 576, T = 4, N = 2304
## 
## Residuals:
##    Min. 1st Qu.  Median 3rd Qu.    Max. 
## -3.0000 -0.1635  0.0000  0.0959  3.0000 
## 
## Coefficients:
##          Estimate Std. Error t-value Pr(&gt;|t|)    
## verhint1   0.3459     0.0161    21.5   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Total Sum of Squares:    702
## Residual Sum of Squares: 554
## R-Squared:      0.212
## Adj. R-Squared: -0.0512
## F-statistic: 463.924 on 1 and 1727 DF, p-value: &lt;2e-16</code></pre>
<ul>
<li>Der Output von <code>summary()</code> liefert eine korrekte Beschreibung der Fallzahlen im Datensatz.</li>
<li>Beachte: Das angepasste <span class="math inline">\(R^2\)</span> ist hier (wie in vielen <em>fixed effects</em> Modellen) negativ. Das ist kein Grund zur Beunruhigung. Die Logik dahinter kann gut nachvollzogen werden, wenn wir uns die LSDV-Spezifikation in Erinnerung rufen. Zusätzlich zu den inhaltlich relevanten Prädiktoren enthält das Modell <span class="math inline">\(n - 1\)</span> Prädiktoren für die Einheiten.</li>
</ul>
</div>
<div id="mehre-fixed-effects-in-einem-modell-perioden-effekte-mit-plm" class="section level3 unnumbered">
<h3>Mehre <em>fixed effects</em> in einem Modell – Perioden-Effekte mit <code>plm</code></h3>
<ul>
<li><code>plm</code> bietet zwei Möglichkeiten, die Perioden-Effekte zu spezifizieren (identische Ergebnisse, anderer Output):</li>
</ul>
<ol style="list-style-type: decimal">
<li>Zwei Indices <code>index=c("IDsosci", "wave")</code> und <code>effect = "twoways"</code> für die within-Transformation.
<ul>
<li>Es wird “still” für Personen und Perioden kontrolliert, beide werden nicht im Output angezeigt.</li>
<li>Das <span class="math inline">\(R^2\)</span> bezieht sich nur auf die Varianzaufklärung durch die Prädiktoren.</li>
</ul></li>
<li>Perioden-Effekt als Dummies hinzufügen.
<ul>
<li>Praktisch, wenn es nur wenige Perioden gibt und wir die Ergebnisse dazu direkt im Output sehen wollen.</li>
<li>Das <span class="math inline">\(R^2\)</span> bezieht sich auf die Varianzaufklärung durch die Prädiktoren und den Perioden-Effekt.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="fixed-effects-modelle.html#cb21-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">plm</span>(verh1 <span class="op">~</span><span class="st"> </span>verhint1, <span class="dt">data =</span> ., <span class="dt">index =</span> <span class="kw">c</span>(<span class="st">&quot;IDsosci&quot;</span>, <span class="st">&quot;wave&quot;</span>), <span class="dt">model =</span> <span class="st">&quot;within&quot;</span>, </span>
<span id="cb21-2"><a href="fixed-effects-modelle.html#cb21-2"></a>    <span class="dt">effect =</span> <span class="st">&quot;twoways&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>## Twoways effects Within Model
## 
## Call:
## plm(formula = verh1 ~ verhint1, data = ., effect = &quot;twoways&quot;, 
##     model = &quot;within&quot;, index = c(&quot;IDsosci&quot;, &quot;wave&quot;))
## 
## Balanced Panel: n = 576, T = 4, N = 2304
## 
## Residuals:
##    Min. 1st Qu.  Median 3rd Qu.    Max. 
## -3.0705 -0.1806  0.0117  0.1316  3.0494 
## 
## Coefficients:
##          Estimate Std. Error t-value Pr(&gt;|t|)    
## verhint1   0.3288     0.0166    19.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Total Sum of Squares:    670
## Residual Sum of Squares: 546
## R-Squared:      0.185
## Adj. R-Squared: -0.0886
## F-statistic: 391.609 on 1 and 1724 DF, p-value: &lt;2e-16</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="fixed-effects-modelle.html#cb23-1"></a>mdl_pfe_pdv =<span class="st"> </span>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">plm</span>(verh1 <span class="op">~</span><span class="st"> </span>verhint1 <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(wave), <span class="dt">data =</span> ., <span class="dt">index =</span> <span class="st">&quot;IDsosci&quot;</span>, </span>
<span id="cb23-2"><a href="fixed-effects-modelle.html#cb23-2"></a>    <span class="dt">model =</span> <span class="st">&quot;within&quot;</span>)</span>
<span id="cb23-3"><a href="fixed-effects-modelle.html#cb23-3"></a>mdl_pfe_pdv <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>## Oneway (individual) effect Within Model
## 
## Call:
## plm(formula = verh1 ~ verhint1 + factor(wave), data = ., model = &quot;within&quot;, 
##     index = &quot;IDsosci&quot;)
## 
## Balanced Panel: n = 576, T = 4, N = 2304
## 
## Residuals:
##    Min. 1st Qu.  Median 3rd Qu.    Max. 
## -3.0705 -0.1806  0.0117  0.1316  3.0494 
## 
## Coefficients:
##               Estimate Std. Error t-value Pr(&gt;|t|)    
## verhint1        0.3288     0.0166   19.79  &lt; 2e-16 ***
## factor(wave)2   0.0200     0.0336    0.60  0.55169    
## factor(wave)3   0.1400     0.0337    4.15 0.000034 ***
## factor(wave)4   0.1178     0.0345    3.41  0.00065 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Total Sum of Squares:    702
## Residual Sum of Squares: 546
## R-Squared:      0.223
## Adj. R-Squared: -0.0377
## F-statistic: 123.824 on 4 and 1724 DF, p-value: &lt;2e-16</code></pre>
</div>
<div id="robuste-standardfehler" class="section level3 unnumbered">
<h3>Robuste Standardfehler</h3>
<ul>
<li><p>In der ökonometrischen Diskussion ist die Wahl der korrekten (robusten) Standardfehler sehr prominent. Diese sind robust gegen Verletzung verschiedener Annahmen, z.B. durch serielle Korrelationen der Residuen oder Heteroskedastizität.</p></li>
<li><p>Das <code>lmtest</code> Paket <span class="citation">(Hothorn et al. <a href="#ref-R-lmtest" role="doc-biblioref">2019</a>)</span> ist kompatibel mit Modellen aus <code>plm</code>. Es implementiert zahlreiche robuste Schätzer bzw. Korrekturen.</p></li>
<li><p>Hier die “normalen” Standardfehler und bei Heteroskedastizität robuste Standardfehler sowie die darauf basierenden Konfidenzintervalle im Vergleich.</p></li>
<li><p>Weiter wollen wir dieses Thema hier nicht vertiefen. Ich empfehle für die Details der Umsetzung in <code>plm</code> <span class="citation">Millo (<a href="#ref-plm2017" role="doc-biblioref">2017</a>)</span> und zu einer kritischen Auseinandersetzung <span class="citation">King and Roberts (<a href="#ref-kingHowRobustStandard2015" role="doc-biblioref">2015</a>)</span>.</p></li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="fixed-effects-modelle.html#cb25-1"></a><span class="co"># Normale SE und CI</span></span>
<span id="cb25-2"><a href="fixed-effects-modelle.html#cb25-2"></a>mdl_pfe_pdv <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coeftest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##               Estimate Std. Error t value Pr(&gt;|t|)    
## verhint1         0.329      0.017   19.79   &lt;2e-16 ***
## factor(wave)2    0.020      0.034    0.60    0.552    
## factor(wave)3    0.140      0.034    4.15   &lt;2e-16 ***
## factor(wave)4    0.118      0.034    3.42    0.001 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="fixed-effects-modelle.html#cb27-1"></a>mdl_pfe_pdv <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coefci</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                2.5 % 97.5 %
## verhint1       0.296  0.361
## factor(wave)2 -0.046  0.086
## factor(wave)3  0.074  0.206
## factor(wave)4  0.050  0.185</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="fixed-effects-modelle.html#cb29-1"></a><span class="co"># Heteroskedasticity-robust SE and CI</span></span>
<span id="cb29-2"><a href="fixed-effects-modelle.html#cb29-2"></a>mdl_pfe_pdv <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coeftest</span>(<span class="dt">vcov. =</span> vcovHC) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##               Estimate Std. Error t value Pr(&gt;|t|)    
## verhint1         0.329      0.028   11.87   &lt;2e-16 ***
## factor(wave)2    0.020      0.029    0.69     0.49    
## factor(wave)3    0.140      0.036    3.85   &lt;2e-16 ***
## factor(wave)4    0.118      0.032    3.70   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="fixed-effects-modelle.html#cb31-1"></a>mdl_pfe_pdv <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coefci</span>(<span class="dt">vcov. =</span> vcovHC) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                2.5 % 97.5 %
## verhint1       0.274  0.383
## factor(wave)2 -0.037  0.077
## factor(wave)3  0.069  0.211
## factor(wave)4  0.055  0.180</code></pre>
</div>
<div id="aufnahme-weiterer-über-die-zeit-variierender-prädiktoren" class="section level3 unnumbered">
<h3>Aufnahme weiterer über die Zeit variierender Prädiktoren</h3>
<ul>
<li><p>Die Aufnahme weiterer Prädiktoren, die über die Zeit variieren, erfolgt prinzipiell wie im bekannten OLS Modell.</p></li>
<li><p>Wichtig ist, dass es bei <em>fixed effects</em> Modellen explizit um das Schätzen von kausalen Effekten geht. Entsprechend bedacht sollte die Auswahl von weiteren Prädiktoren sein. Ein “kitchen sink” Ansatz, den man vor allem in OLS mit Querschnittsdaten sieht, ist hier nicht angebracht. Es muss (wie eigentlich immer) darauf geachtet werden, welche Koeffizienten eines Regressionsmodells kausal interpretiert werden dürfen <span class="citation">(Keele, Stevenson, and Elwert <a href="#ref-keeleCausalInterpretationEstimated2019" role="doc-biblioref">2019</a>)</span>. Im <em>fixed effects</em> Modell müssen wir uns das ganz explizit vergegenwärtigen und in der Ergebnisdarstellung berücksichtigen, da die Modellklasse kausale Effekte impliziert.</p></li>
<li><p>Nach der TPB dürfen wir dieses Modell annehmen, da die drei Prädiktoren auf derselben kausalen Stufe stehen: Verhaltensintention ~ Einstellung + Deskriptive Norm + Injunktive Norm. Hier schätzen wir das Modell für die Verhaltensintention <em>Rausgehen ohne triftigen Grund</em>.</p></li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="fixed-effects-modelle.html#cb33-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">plm</span>(verhint1 <span class="op">~</span><span class="st"> </span>ein1 <span class="op">+</span><span class="st"> </span>desnormp1 <span class="op">+</span><span class="st"> </span>injnormp1 <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(wave), <span class="dt">data =</span> ., <span class="dt">index =</span> <span class="st">&quot;IDsosci&quot;</span>, </span>
<span id="cb33-2"><a href="fixed-effects-modelle.html#cb33-2"></a>    <span class="dt">model =</span> <span class="st">&quot;within&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_if</span>(is.numeric, round, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   term          estimate std.error statistic p.value
##   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 ein1              0.31      0.02     12.4     0   
## 2 desnormp1         0.05      0.03      1.56    0.12
## 3 injnormp1         0.1       0.03      3.31    0   
## 4 factor(wave)2     0.21      0.05      4.69    0   
## 5 factor(wave)3     0.24      0.05      5.3     0   
## 6 factor(wave)4     0.39      0.05      8.32    0</code></pre>
<ul>
<li>Vor allem die Einstellung zum Verhalten und die wahrgenommenen normativen Erwartungen haben stärkere kausale Effekte auf die Verhaltensintention.</li>
</ul>
</div>
<div id="aufnahme-eines-personenmerkmals-funktioniert-nicht-ohne-warnung" class="section level3 unnumbered">
<h3>Aufnahme eines Personenmerkmals (funktioniert nicht, ohne Warnung!)</h3>
<ul>
<li>In einer typischen Regresssionanalyse würden wir uns z.B. auch dafür interessieren, ob sich das Verhalten nach dem Geschlecht unterscheidet. Wir nehmen also <code>C_sex</code> in die Formel auf, mit der wir das Modell in <code>plm</code> spezifizieren.</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="fixed-effects-modelle.html#cb35-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">plm</span>(verh1 <span class="op">~</span><span class="st"> </span>verhint1 <span class="op">+</span><span class="st"> </span>C_sex <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(wave), <span class="dt">data =</span> ., <span class="dt">index =</span> <span class="st">&quot;IDsosci&quot;</span>, <span class="dt">model =</span> <span class="st">&quot;within&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-2"><a href="fixed-effects-modelle.html#cb35-2"></a><span class="st">    </span>summary</span></code></pre></div>
<pre><code>## Oneway (individual) effect Within Model
## 
## Call:
## plm(formula = verh1 ~ verhint1 + C_sex + factor(wave), data = ., 
##     model = &quot;within&quot;, index = &quot;IDsosci&quot;)
## 
## Balanced Panel: n = 576, T = 4, N = 2304
## 
## Residuals:
##    Min. 1st Qu.  Median 3rd Qu.    Max. 
## -3.0705 -0.1806  0.0117  0.1316  3.0494 
## 
## Coefficients:
##               Estimate Std. Error t-value Pr(&gt;|t|)    
## verhint1        0.3288     0.0166   19.79  &lt; 2e-16 ***
## factor(wave)2   0.0200     0.0336    0.60  0.55169    
## factor(wave)3   0.1400     0.0337    4.15 0.000034 ***
## factor(wave)4   0.1178     0.0345    3.41  0.00065 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Total Sum of Squares:    702
## Residual Sum of Squares: 546
## R-Squared:      0.223
## Adj. R-Squared: -0.0377
## F-statistic: 123.824 on 4 and 1724 DF, p-value: &lt;2e-16</code></pre>
<ul>
<li>Geschlecht wird nicht in das Modell aufgenommen. Vorsicht: Es taucht einfach nicht im Ergebnis auf, obwohl es in der Formel steht (siehe <code>Call</code> in der Summary)</li>
</ul>
</div>
<div id="warum-wird-das-personenmerkmal-nicht-ins-modell-aufgenomen" class="section level3 unnumbered">
<h3>Warum wird das Personenmerkmal nicht ins Modell aufgenomen?</h3>
<ul>
<li>Within-person Transformation entfernt die gesamte between-person Varianz aus den Daten: <span class="math inline">\(\bar{y_{i}} = 0\)</span>.</li>
<li>Daher können innerhalb der Personen invariante Merkmale keine Unterschiede erklären.</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="fixed-effects-modelle.html#cb37-1"></a>id_smple =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">unique</span>(d<span class="op">$</span>IDsosci), <span class="dv">100</span>)</span>
<span id="cb37-2"><a href="fixed-effects-modelle.html#cb37-2"></a>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(IDsosci <span class="op">%in%</span><span class="st"> </span>id_smple) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(IDsosci, wave, verh1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(IDsosci) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-3"><a href="fixed-effects-modelle.html#cb37-3"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">verh1_within =</span> verh1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(verh1)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(transformation, </span>
<span id="cb37-4"><a href="fixed-effects-modelle.html#cb37-4"></a>    value, <span class="op">-</span>IDsosci, <span class="op">-</span>wave) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(wave, value, <span class="dt">group =</span> IDsosci)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="dv">0</span>, </span>
<span id="cb37-5"><a href="fixed-effects-modelle.html#cb37-5"></a>    <span class="dt">height =</span> <span class="fl">0.3</span>), <span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="st">&quot;transformation&quot;</span>)</span></code></pre></div>
<p><img src="workshop_panel_files/figure-html/vis-ex2-1.png" width="672" /></p>
<ul>
<li><p>Die Abbildung verdeutlicht dies anhand von 100 zufällig ausgewählten Personen aus dem Datensatz. Vor der Transformation gibt es (etwas) Varianz im Level des berichteten Verhaltens zwischen den Personen. Durch die Transformation verschwinden diese Unterschiede, es bleibt nur die Variation innerhalb der Personen über die Zeit.</p></li>
<li><p>Das gleiche gilt für Prädiktoren, die als Merkmale anderer Einheiten, die wir als <em>fixed effects</em> spezifiziert haben, konstant sind. In diesem Beispiel wären dies Eigenschaften der Perioden, also z.B. neue Schutzmaßnahmen bzw. deren Lockerung, soweit sie alle Personen gleichermaßen im gleichen Zeitraum betreffen.</p></li>
</ul>
</div>
<div id="interaktionen-mit-personenmerkmalen" class="section level3 unnumbered">
<h3>Interaktionen mit Personenmerkmalen</h3>
<ul>
<li>Wir können jedoch Interaktionen zwischen über die Zeit variierenden Prädiktoren und Personenmerkmalen (oder Merkmalen anderer <em>fixed effects</em> Einheiten) ins Modell aufnehmen.</li>
<li>Bei kategoriellen Moderator-Variablen erhalten wir Schätzer der Unterschiede zwischen gruppenspezifischen Effekten, z.B. den Unterschied zwischen den Effekten der Verhaltensintention auf das Verhalten für Frauen und Männer.</li>
<li>Bei kontinuierlichen Moderator-Variablen gelten die üblichen Fallstricke: Der Koeffizient des Prädiktors ist nun der einfache Effekt für den Fall, dass der Moderator gleich 0 ist. Der Koeffizient des Interaktionsterms quantifiziert den Unterschied des Effekts zwischen zwei Personen, die sich auf dem Moderator um eine Einheit unterscheiden.</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="fixed-effects-modelle.html#cb38-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">plm</span>(verh1 <span class="op">~</span><span class="st"> </span>verhint1 <span class="op">*</span><span class="st"> </span>C_sex <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(wave), <span class="dt">data =</span> ., <span class="dt">index =</span> <span class="st">&quot;IDsosci&quot;</span>, <span class="dt">model =</span> <span class="st">&quot;within&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-2"><a href="fixed-effects-modelle.html#cb38-2"></a><span class="st">    </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_if</span>(is.numeric, round, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 5
##   term           estimate std.error statistic p.value
##   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 verhint1           0.34      0.03     13.2     0   
## 2 factor(wave)2      0.02      0.03      0.59    0.55
## 3 factor(wave)3      0.14      0.03      4.14    0   
## 4 factor(wave)4      0.12      0.03      3.42    0   
## 5 verhint1:C_sex    -0.01      0.03     -0.39    0.7</code></pre>
<ul>
<li>Der Effekt ist in der Stichprobe für Frauen minimal schwächer als für Männer. Der Unterschied ist jedoch weder substantiell noch statistisch bedeutsam.</li>
</ul>
</div>
</div>
<div id="zusammenfassung-vor--und-nachteile-des-fixed-effects-modells" class="section level2">
<h2><span class="header-section-number">3.4</span> Zusammenfassung: Vor- und Nachteile des <em>fixed effects</em> Modells</h2>
<blockquote>
<p>In many applications the whole point of using panel data is to allow for <span class="math inline">\(a_i\)</span> to be arbitrarily correlated with the <span class="math inline">\(x_{it}\)</span>. A fixed effects analysis achieves this purpose explicitly. — <span class="citation">Wooldridge (<a href="#ref-wooldridge10" role="doc-biblioref">2010</a>)</span>, S. 300</p>
</blockquote>
<blockquote>
<p>By controlling out context, FE models effectively cut out much of what is going on — goings-on that are usually of interest to the researcher, the reader and the policy maker. We contend that models that control out, rather than explicitly model, context and heterogeneity offer overly simplistic and impoverished results that can lead to misleading interpretations. — <span class="citation">Bell and Jones (<a href="#ref-bellExplainingFixedEffects2015" role="doc-biblioref">2015</a>)</span>, S. 134</p>
</blockquote>
<ul>
<li><p>Das <em>fixed effects</em> Modell ist nützlich, wenn wir einen kausalen Effekt, der sich innerhalb von Einheiten (Personen) abspielt, schätzen wollen.</p></li>
<li><p>Das <em>fixed effects</em> Modell kann keine Merkmale der Einheiten (Personen) als Prädiktoren berücksichtigen, da die gesamten einheiten(personen)spezifischen Unterschiede bereits durch die <em>fixed effects</em> erklärt werden.</p></li>
<li><p>Wir interessieren uns aber häufig (auch) für die Unterschiede zwischen Einheiten (Personen). Das <em>fixed effects</em> Modell macht Antworten auf solche Fragen unmöglich.</p></li>
<li><p>Ein weiterer, damit unverbundener Nachteil des <em>fixed effects</em> Modells ist die starke Anfälligkeit für Messfehler. Die Transformation verringert die wahre Varianz deutlich, während große Teile der Messfehlervarianz erhalten bleiben (sie sind nicht personenspezifisch).</p></li>
</ul>
</div>
<div id="übungsaufgaben-2" class="section level2">
<h2><span class="header-section-number">3.5</span> Übungsaufgaben 2</h2>
<ol style="list-style-type: decimal">
<li>Schätze den kausalen Effekt der Einstellung zum Verhalten, weniger als 1.5m Abstand zu Personen zu halten, die nicht im gleichen Haushalt leben <code>ein3</code>, auf die diesbezügliche Verhaltensintention (<code>verhint3</code>). Berücksichtige dabei die Periodeneffekte der Panelwellen. Siehe dazu auch Übung 1.
<ul>
<li>Verwende jetzt <code>plm</code> für die Schätzung.</li>
<li>Nimm zusätzlich die wahrgenommene deskriptive Norm <code>desnormp3</code> in das Modell auf.</li>
<li>Prüfe, ob sich die Effekte nach Geschlecht (<code>C_sex</code>) unterscheiden.</li>
</ul></li>
<li>Spezifiziere, schätze und interpretiere ein eigenes <em>fixed effects</em> Modell mit Daten aus dem Beispieldatensatz. Nutze dabei alle Techniken (unterschiedliche Spezifikation, Standardfehler, Moderation, mehrere Prädiktoren), die du ausprobieren und zu denen du ggf. Fragen stellen willst.</li>
</ol>

</div>
</div>
<h3>Literatur</h3>
<div id="refs" class="references">
<div id="ref-bellExplainingFixedEffects2015">
<p>Bell, Andrew, and Kelvyn Jones. 2015. “Explaining Fixed Effects: Random Effects Modeling of Time-Series Cross-Sectional and Panel Data.” <em>Political Science Research and Methods</em> 3 (1): 133–53. <a href="https://doi.org/10.1017/psrm.2014.7">https://doi.org/10.1017/psrm.2014.7</a>.</p>
</div>
<div id="ref-R-plm">
<p>Croissant, Yves, Giovanni Millo, and Kevin Tappe. 2020. <em>Plm: Linear Models for Panel Data</em>. <a href="https://CRAN.R-project.org/package=plm">https://CRAN.R-project.org/package=plm</a>.</p>
</div>
<div id="ref-R-lmtest">
<p>Hothorn, Torsten, Achim Zeileis, Richard W. Farebrother, and Clint Cummins. 2019. <em>Lmtest: Testing Linear Regression Models</em>. <a href="https://CRAN.R-project.org/package=lmtest">https://CRAN.R-project.org/package=lmtest</a>.</p>
</div>
<div id="ref-keeleCausalInterpretationEstimated2019">
<p>Keele, Luke, Randolph T. Stevenson, and Felix Elwert. 2019. “The Causal Interpretation of Estimated Associations in Regression Models.” <em>Political Science Research and Methods</em>, 1–13. <a href="https://doi.org/10.1017/psrm.2019.31">https://doi.org/10.1017/psrm.2019.31</a>.</p>
</div>
<div id="ref-kingHowRobustStandard2015">
<p>King, Gary, and Margaret E. Roberts. 2015. “How Robust Standard Errors Expose Methodological Problems They Do Not Fix, and What to Do About It.” <em>Political Analysis</em> 23 (2): 159–79. <a href="https://doi.org/10.1093/pan/mpu015">https://doi.org/10.1093/pan/mpu015</a>.</p>
</div>
<div id="ref-plm2017">
<p>Millo, Giovanni. 2017. “Robust Standard Error Estimators for Panel Models: A Unifying Approach.” <em>Journal of Statistical Software</em> 82 (3): 1–27. <a href="https://doi.org/10.18637/jss.v082.i03">https://doi.org/10.18637/jss.v082.i03</a>.</p>
</div>
<div id="ref-wooldridge10">
<p>Wooldridge, Jeffrey M. 2010. <em>Econometric Analysis of Cross Section and Panel Data</em>. MIT press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="einführung.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="random-effects-modelle.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["workshop_panel.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
