[
["hybride-within-between-modelle.html", "Abschnitt 5 Hybride within-between Modelle 5.1 Das Beste aus beiden Welten? 5.2 Spezifikation des within-between Modells", " Abschnitt 5 Hybride within-between Modelle 5.1 Das Beste aus beiden Welten? Ein häufiger Einwand gegen random effects Panelmodelle ist, dass die Annahme nicht korrelierter über die Zeit konstanter Variablen (beobachtet wie unbeobachtet) so stark ist, dass sie in den Sozialwissenschaften eigentlich nie einzuhalten ist (siehe Abschnitt 4.1). Trotzdem sind random effects Panelmodelle weit verbreitet, da sie uns erlauben, über die Zeit variierende Variablen und über die Zeit konstante Personenmerkmale als Prädiktoren in ein Modell aufzunehmen. Häufig sind wir eben sowohl an kausalen Effekten als auch an Unterschieden zwischen Personen interessiert. Außerdem ist gerade die Möglichkeit, unspezifische Heterogenität in Treatment-Effekten zuzulassen, in den Sozialwissenschaften sehr attraktiv. Eigentlich gehen wir fast immer davon aus, dass Effekte variabel sind und nicht alle Personen gleichermaßen betreffen. Das hybride within-between Modell verspricht, unverzerrte kausale within-person Effekte der über die Zeit variierenden Prädiktoren und between-person Vergleiche innerhalb eines Modells zu schätzen. Dazu werden die über die Zeit variierenden Prädiktoren transformiert und in zwei Variablen aufgeteilt: \\(x_{it}-\\bar{x_i}\\) ist der um den Personen-Mittelwert bereinigte within-person Prädiktor. \\(\\bar{x_i}\\) ist der Personen-Mittelwert als between-person Prädiktor. Der Koeffizient des within-person Prädiktors entspricht dem fixed effects Schätzer (siehe Abschnitt 3.1, Within Transformation). Der Koeffizient des between-person Prädiktors quantifiziert die Unterschiede der Personen in \\(y\\), die durch über die Zeit stabile Unterschiede in \\(x\\) erklärt werden. Ein Blick auf die Varianzaufklärung im ersten Beispiel zum random effects Panelmodell in Abschnitt 4.5 zeigt, warum die Trennung dieser beiden Effekte sinnvoll ist. Das Ergebnis ist hier noch einmal reproduziert. m1 %&gt;% summary(correlation = FALSE) ## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [ ## lmerModLmerTest] ## Formula: verh1 ~ verhint1 + (1 | IDsosci) ## Data: d ## ## REML criterion at convergence: 4554 ## ## Scaled residuals: ## Min 1Q Median 3Q Max ## -4.524 -0.202 -0.085 0.165 5.793 ## ## Random effects: ## Groups Name Variance Std.Dev. ## IDsosci (Intercept) 0.111 0.334 ## Residual 0.341 0.584 ## Number of obs: 2304, groups: IDsosci, 576 ## ## Fixed effects: ## Estimate Std. Error df t value Pr(&gt;|t|) ## (Intercept) 0.5987 0.0287 975.4311 20.9 &lt;2e-16 *** ## verhint1 0.5155 0.0122 1747.0982 42.3 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 r2(m1, by_group = TRUE) ## # Explained Variance by Level ## ## Level | R2 ## --------------- ## Level 1 | 0.161 ## IDsosci | 0.812 Die Verhaltensintention erklärt sowohl 81% der Varianz zwischen den Personen als auch 16% der Varianz innerhalb der Personen. Wir erhalten aber nur einen Koeffizienten, in dem der within-person Effekt und der between-person Unterschied untrennbar vermischt sind. 5.2 Spezifikation des within-between Modells Wir untersuchen wieder den Effekt der Intention, die Wohnung ohne triftigen Grund zu verlassen, auf den Bericht, dies getan zu haben. # Transformation: Trennen von within- und between-Prädiktor d = d %&gt;% group_by(IDsosci) %&gt;% mutate(verhint1_w = verhint1 - mean(verhint1), # within verhint1_b = mean(verhint1)) %&gt;% # between ungroup() # Zwei Personen zur Illustration d %&gt;% filter(IDsosci %in% c(&quot;050IPY&quot;, &quot;02E6C8&quot;)) %&gt;% select(IDsosci, wave, starts_with(&quot;verhint1&quot;)) ## # A tibble: 8 x 5 ## IDsosci wave verhint1 verhint1_w verhint1_b ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 02E6C8 1 1 -1 2 ## 2 02E6C8 2 2 0 2 ## 3 02E6C8 3 2 0 2 ## 4 02E6C8 4 3 1 2 ## 5 050IPY 1 3 -1 4 ## 6 050IPY 2 3 -1 4 ## 7 050IPY 3 5 1 4 ## 8 050IPY 4 5 1 4 Zuerst transformieren wir den Prädiktor verhint1 in einen within-Prädiktor verhint1_w und einen between-Prädiktor verhint1_b. Am Beispiel von zwei Personen können wir sehen, dass verhint1_b der Mittelwert der Person über die vier Wellen ist und verhint1_w der Messwert in einer Welle bereinigt um den Mittelwert. Es wird auch direkt deutlich, dass verhint1_b nun per Transformationslogik eine über die Zeit konstante Personeneigenschaft ist. Die Spezifikation des Modells mit lme4::lmer() folgt derselben Logik wie das random effects Panelmodell in Abschnitt 4. Als Referenz ziehen wir das entsprechende Null-Modell inklusive der fixed effects für die Panelwellen heran. Wir beginnen wieder mit einem random intercept Modell, (1 | IDsosci). verhint1_w und verhint1_b werden als Prädiktoren in das Modell aufgenommen. # Null-Modell als Referenz wb_0 = lmer(verh1 ~ 1 + factor(wave) + (1 | IDsosci), data = d) # Within-between Modell mit random intercept wb_ri = lmer(verh1 ~ verhint1_w + verhint1_b + factor(wave) + (1 | IDsosci), data = d) wb_ri %&gt;% summary(correlation = FALSE) ## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [ ## lmerModLmerTest] ## Formula: verh1 ~ verhint1_w + verhint1_b + factor(wave) + (1 | IDsosci) ## Data: d ## ## REML criterion at convergence: 4303 ## ## Scaled residuals: ## Min 1Q Median 3Q Max ## -5.289 -0.318 -0.044 0.166 6.372 ## ## Random effects: ## Groups Name Variance Std.Dev. ## IDsosci (Intercept) 0.0755 0.275 ## Residual 0.3165 0.563 ## Number of obs: 2304, groups: IDsosci, 576 ## ## Fixed effects: ## Estimate Std. Error df t value Pr(&gt;|t|) ## (Intercept) 0.1689 0.0392 1069.4869 4.31 0.000018 *** ## verhint1_w 0.3288 0.0166 1724.0000 19.79 &lt; 2e-16 *** ## verhint1_b 0.7153 0.0159 574.0000 44.86 &lt; 2e-16 *** ## factor(wave)2 0.0200 0.0336 1724.0000 0.60 0.55169 ## factor(wave)3 0.1400 0.0337 1724.0000 4.15 0.000034 *** ## factor(wave)4 0.1178 0.0345 1724.0000 3.41 0.00065 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 # Varianzreduktion 1 - (sigma(wb_ri)^2/sigma(wb_0)^2) # L1 ## [1] 0.18 1 - (as.numeric(VarCorr(wb_ri)$IDsosci)/as.numeric(VarCorr(wb_0)$IDsosci)) # L2 ## [1] 0.87 # Vergleich mit fixed effects Modell fe = plm(verh1 ~ verhint1 + factor(wave), data = d, index = &quot;IDsosci&quot;, model = &quot;within&quot;) fe %&gt;% summary() %&gt;% coef() ## Estimate Std. Error t-value Pr(&gt;|t|) ## verhint1 0.33 0.017 19.8 1.0e-78 ## factor(wave)2 0.02 0.034 0.6 5.5e-01 ## factor(wave)3 0.14 0.034 4.2 3.4e-05 ## factor(wave)4 0.12 0.034 3.4 6.5e-04 "]
]
